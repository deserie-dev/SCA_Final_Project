(this["webpackJsonparound-react"]=this["webpackJsonparound-react"]||[]).push([[0],{28:function(e,t,n){},38:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n.n(a),c=n(17),i=n.n(c),s=(n(28),n(22)),r=n(2),l=n(3),u=n.p+"static/media/logo.4e8e0a1d.svg",d=n(8),m=n(0);var j=function(e){var t=e.email,n=e.link,a=e.linkText,o=e.onLogOut,c=Object(l.h)().pathname;return"/signin"===c?(a="Sign up",n="/signup"):"/signup"===c?(a="Log in",n="/signin"):"/"===c&&(a="Log out",n="/signin"),Object(m.jsxs)("header",{className:"header",children:[Object(m.jsx)("img",{className:"header__logo",src:u,alt:"Around The World"}),Object(m.jsxs)("div",{className:"header__menu",children:[Object(m.jsx)("p",{className:"header__menu-item",children:t}),Object(m.jsx)(d.b,{className:"header__menu-item",to:n,onClick:o,children:a})]})]})},h=o.a.createContext();var b=function(e){var t=o.a.useContext(h),n=e.card.owner._id===(null===t||void 0===t?void 0:t._id),a=e.card.likes.some((function(e){return e._id===(null===t||void 0===t?void 0:t._id)})),c="elements__delete-button ".concat(n?"elements__delete-button_visible":"elements__delete-button_hidden"),i="elements__like ".concat(a?"elements__like_active":"");return Object(m.jsxs)("li",{className:"elements__item",children:[Object(m.jsx)("img",{className:"elements__image",alt:e.name,src:e.link,onClick:function(){e.onCardClick(e.card)}}),Object(m.jsx)("button",{className:c,type:"button",onClick:function(){e.onCardDelete(e.card)}}),Object(m.jsxs)("div",{className:"elements__heading",children:[Object(m.jsx)("h2",{className:"elements__title",children:e.name}),Object(m.jsxs)("div",{className:"elements__like-container",children:[Object(m.jsx)("button",{className:i,type:"button","aria-label":"like button",onClick:function(){e.onCardLike(e.card)}}),Object(m.jsx)("p",{className:"elements__like-counter",children:e.likes.length})]})]})]})};var p=function(e){var t=o.a.useContext(h);return Object(m.jsxs)("main",{className:"content",children:[Object(m.jsxs)("section",{className:"profile",children:[Object(m.jsxs)("div",{className:"profile__avatar",children:[Object(m.jsx)("img",{className:"profile__image",src:t.avatar,alt:"Avatar"}),Object(m.jsx)("button",{className:"profile__image-edit",onClick:e.onEditAvatarClick})]}),Object(m.jsxs)("div",{className:"profile__content",children:[Object(m.jsxs)("div",{className:"profile__details",children:[Object(m.jsx)("h1",{className:"profile__name",children:t.name}),Object(m.jsx)("button",{type:"button","aria-label":"edit button",className:"profile__edit",onClick:e.onEditProfileClick})]}),Object(m.jsx)("p",{className:"profile__occupation",children:t.about})]}),Object(m.jsx)("button",{className:"profile__add",type:"button","aria-label":"add button",onClick:e.onAddPlaceClick})]}),Object(m.jsx)("section",{className:"elements",children:Object(m.jsx)("ul",{className:"elements__container",children:e.cards.map((function(t){return Object(m.jsx)(b,{card:t,name:t.name,id:t._id,link:t.link,likes:t.likes,onCardDelete:e.onCardDelete,onCardLike:e.onCardLike,onCardClick:e.onCardClick},t._id)}))})})]})};var _=function(){return Object(m.jsx)("footer",{className:"footer",children:Object(m.jsx)("p",{className:"footer__author",children:"\xa9 2021 Around The U.S."})})};var f=function(e){return Object(m.jsx)("div",{className:"modal modal_type_".concat(e.name," ").concat(e.isOpen?"modal_opened":""),children:Object(m.jsxs)("div",{className:"modal__container",children:[Object(m.jsxs)("form",{className:"modal__form modal__form_type_".concat(e.name),name:e.name,onSubmit:e.onSubmit,children:[Object(m.jsx)("h3",{className:"modal__title",children:e.title}),e.children,Object(m.jsx)("button",{className:"modal__form-submit",type:"submit","aria-label":"save button",children:e.buttonText})]}),Object(m.jsx)("button",{className:"modal__close-button",type:"button","aria-label":"close button",onClick:e.onClose})]})})};var O=function(e){var t=o.a.useState(),n=Object(r.a)(t,2),a=n[0],c=n[1],i=o.a.useState(),s=Object(r.a)(i,2),l=s[0],u=s[1];return Object(m.jsxs)(f,{name:"create",title:"New place",buttonText:"Create",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onAddPlace({name:a,link:l}),c(""),u("")},children:[Object(m.jsx)("input",{id:"placeTitle",className:"modal__form-control modal__form-control_input_title",type:"text",placeholder:"Title",name:"titleInput",required:!0,minLength:"1",maxLength:"30",value:a,onChange:function(e){c(e.target.value)}}),Object(m.jsx)("span",{id:"placeTitle-error",className:"modal__error"}),Object(m.jsx)("input",{id:"placeLink",className:"modal__form-control modal__form-control_input_image",type:"url",placeholder:"Image Link",name:"imageLinkInput",required:!0,value:l,onChange:function(e){u(e.target.value)}}),Object(m.jsx)("span",{id:"placeLink-error",className:"modal__error"})]})};var g=function(e){var t=o.a.useRef();return Object(m.jsxs)(f,{name:"avatar",title:"Change Profile Picture",buttonText:"Save",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(n){n.preventDefault(),e.onUpdateAvatar({avatar:t.current.value})},children:[Object(m.jsx)("input",{ref:t,id:"avatar-url",className:"modal__form-control modal__form-control_avatar",type:"url",placeholder:"Image Link",name:"avatarInput",required:!0}),Object(m.jsx)("span",{id:"avatar-url-error",className:"modal__error"})]})};var v=function(e){var t=o.a.useContext(h),n=o.a.useState(""),a=Object(r.a)(n,2),c=a[0],i=a[1],s=o.a.useState(""),l=Object(r.a)(s,2),u=l[0],d=l[1];return o.a.useEffect((function(){i(t.name),d(t.about)}),[t,e.isOpen]),Object(m.jsxs)(f,{name:"edit",title:"Edit Profile",buttonText:"Save",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:c,about:u})},children:[Object(m.jsx)("input",{value:c||"",id:"profileName",className:"modal__form-control modal__form-control_input_name",type:"text",placeholder:"Name",name:"profileNameInput",required:!0,minLength:"2",maxLength:"40",onChange:function(e){i(e.target.value)}}),Object(m.jsx)("span",{id:"profileName-error",className:"modal__error"}),Object(m.jsx)("input",{value:u||"",id:"profileOccupation",className:"modal__form-control modal__form-control_input_occupation",type:"text",placeholder:"Occupation",name:"profileOccupationInput",required:!0,minLength:"2",maxLength:"200",onChange:function(e){d(e.target.value)}}),Object(m.jsx)("span",{id:"profileOccupation-error",className:"modal__error"})]})};var x=function(e){return Object(m.jsx)(f,{name:"deleteConfirmation",title:"Are you sure?",buttonText:"Yes",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onSubmit(e.cardToDelete)}})};var k=function(e){var t,n,a;return Object(m.jsx)("div",{className:"modal modal_type_image ".concat(e.card?"modal_opened":""),children:Object(m.jsxs)("div",{className:"modal__container modal__container_preview",children:[Object(m.jsx)("button",{className:"modal__close-button  modal__close-button_preview",type:"button","aria-label":"close button",onClick:e.onClose}),Object(m.jsxs)("figure",{children:[Object(m.jsx)("img",{className:"modal__image",src:null===(t=e.card)||void 0===t?void 0:t.link,alt:null===(n=e.card)||void 0===n?void 0:n.name}),Object(m.jsx)("figcaption",{className:"modal__image-title",children:null===(a=e.card)||void 0===a?void 0:a.name})]})]})})};var C=function(e){var t=o.a.useState(""),n=Object(r.a)(t,2),a=n[0],c=n[1],i=o.a.useState(""),s=Object(r.a)(i,2),l=s[0],u=s[1];return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(j,{link:"/signup",linkText:"Sign up"}),Object(m.jsx)("div",{className:"modal__form_container",children:Object(m.jsxs)("form",{className:"modal__form",onSubmit:function(t){t.preventDefault(),e.handleLogin(a,l)},children:[Object(m.jsx)("h3",{className:"modal__form_heading",children:"Log in"}),Object(m.jsx)("input",{className:"modal__form_input",placeholder:"Email",type:"email",name:"email",value:a,onChange:function(e){return c(e.target.value)},required:!0}),Object(m.jsx)("input",{className:"modal__form_input",placeholder:"Password",type:"password",name:"password",value:l,onChange:function(e){return u(e.target.value)},required:!0}),Object(m.jsx)("button",{className:"modal__form_submit",type:"submit",children:"Log In"}),Object(m.jsx)(d.b,{className:"modal__link",to:"/signup",children:"Not a member yet? Sign up here!"})]})})]})},N=n(16),y=n(23),S=["children","loggedIn"];var T=function(e){var t=e.children,n=e.loggedIn,a=Object(y.a)(e,S);return Object(m.jsx)(l.b,Object(N.a)(Object(N.a)({},a),{},{children:n?t:Object(m.jsx)(l.a,{to:"./signin"})}))},L=n.p+"static/media/successIcon.1b6082f8.svg",A=n.p+"static/media/errorIcon.df8eddf6.svg";var P=function(e){return Object(m.jsx)("div",{className:"modal modal_type_tooltip ".concat(e.isOpen&&"modal_opened"),children:Object(m.jsxs)("div",{className:"modal__container modal__type_tooltip",children:[Object(m.jsx)("img",{className:"modal__icon",src:e.isRegistered?L:A,alt:"success or error icon"}),Object(m.jsx)("p",{className:"modal__message",children:e.isRegistered?"Success! You have now been registered.":"Oops, something went wrong! Please try again."}),Object(m.jsx)("button",{className:"modal__close-button",type:"button","aria-label":"close button",onClick:e.onClose})]})})};var I=function(e){var t=o.a.useState(""),n=Object(r.a)(t,2),a=n[0],c=n[1],i=o.a.useState(""),s=Object(r.a)(i,2),l=s[0],u=s[1];return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(j,{link:"/signin",linkText:"Log in"}),Object(m.jsx)("div",{className:"modal__form_container",children:Object(m.jsxs)("form",{className:"modal__form",onSubmit:function(t){t.preventDefault(),e.handleRegister(a,l)},children:[Object(m.jsx)("h3",{className:"modal__form_heading",children:"Sign up"}),Object(m.jsx)("input",{className:"modal__form_input",placeholder:"Email",type:"email",name:"email",value:a,onChange:function(e){return c(e.target.value)},required:!0}),Object(m.jsx)("input",{className:"modal__form_input",placeholder:"Password",type:"password",name:"password",value:l,onChange:function(e){return u(e.target.value)},required:!0}),Object(m.jsx)("button",{className:"modal__form_submit",type:"submit","aria-label":"register",children:"Sign Up"}),Object(m.jsx)(d.b,{className:"modal__link",to:"/signin",children:"Already a member? Log in here!"})]})})]})},E=n(20),U=n(21),w=new(function(){function e(t){var n=t.baseUrl,a=t.headers;Object(E.a)(this,e),this._baseUrl=n,this._headers=a}return Object(U.a)(e,[{key:"_checkResponse",value:function(e){return e.ok?e.json():Promise.reject("Error!"+e.statusText)}},{key:"getInitialCards",value:function(e){return fetch(this._baseUrl+"/cards",{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},method:"GET"}).then(this._checkResponse)}},{key:"getUserInfo",value:function(e){return fetch(this._baseUrl+"/users/me",{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},method:"GET"}).then(this._checkResponse)}},{key:"addCard",value:function(e,t){var n=e.name,a=e.link;return fetch(this._baseUrl+"/cards",{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},method:"POST",body:JSON.stringify({name:n,link:a})}).then(this._checkResponse)}},{key:"deleteCard",value:function(e,t){return fetch(this._baseUrl+"/cards/"+e,{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},method:"DELETE"}).then(this._checkResponse)}},{key:"editProfile",value:function(e,t){var n=e.name,a=e.about;return fetch(this._baseUrl+"/users/me",{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},method:"PATCH",body:JSON.stringify({name:n,about:a})}).then(this._checkResponse)}},{key:"editAvatar",value:function(e,t){var n=e.avatar;return fetch(this._baseUrl+"/users/me/avatar",{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},method:"PATCH",body:JSON.stringify({avatar:n})}).then(this._checkResponse)}},{key:"addLike",value:function(e,t){return fetch(this._baseUrl+"/cards/likes/"+e,{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},method:"PUT"}).then(this._checkResponse)}},{key:"removeLike",value:function(e,t){return fetch(this._baseUrl+"/cards/likes/"+e,{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},method:"DELETE"}).then(this._checkResponse)}}]),e}())({baseUrl:"https://api.deserie.students.nomoreparties.site"}),D="https://api.deserie.students.nomoreparties.site";function R(e){return e.ok?e.json():Promise.reject("Error!"+e.statusText)}var B=function(){var e=Object(l.g)(),t=o.a.useState(!1),n=Object(r.a)(t,2),a=n[0],c=n[1],i=o.a.useState(!1),u=Object(r.a)(i,2),d=u[0],b=u[1],f=o.a.useState(!1),N=Object(r.a)(f,2),y=N[0],S=N[1],L=o.a.useState(!1),A=Object(r.a)(L,2),E=A[0],U=A[1],B=o.a.useState(null),q=Object(r.a)(B,2),z=q[0],J=q[1],F=o.a.useState({}),G=Object(r.a)(F,2),H=G[0],Y=G[1],M=o.a.useState([]),W=Object(r.a)(M,2),K=W[0],Q=W[1],V=o.a.useState(),X=Object(r.a)(V,2),Z=X[0],$=X[1],ee=o.a.useState(!1),te=Object(r.a)(ee,2),ne=te[0],ae=te[1],oe=o.a.useState(!1),ce=Object(r.a)(oe,2),ie=ce[0],se=ce[1],re=o.a.useState(!1),le=Object(r.a)(re,2),ue=le[0],de=le[1],me=o.a.useState(""),je=Object(r.a)(me,2),he=je[0],be=je[1],pe=o.a.useState(localStorage.getItem("token")),_e=Object(r.a)(pe,2),fe=_e[0],Oe=_e[1];function ge(){de(!0)}function ve(){c(!1),b(!1),S(!1),U(!1),de(!1),J(null)}function xe(){e.push("/signin"),ae(!1),be(""),localStorage.removeItem("token")}return o.a.useEffect((function(){fe&&function(e){return fetch("".concat(D,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return R(e)})).then((function(e){return e}))}(fe).then((function(t){ae(!0),be(t.user.email),e.push("/")})).catch((function(e){console.log(e)}))}),[e,fe]),o.a.useEffect((function(){w.getUserInfo(fe).then((function(e){Y(e.user)})).catch((function(e){console.log(e)}))}),[fe,null===H||void 0===H?void 0:H._id]),o.a.useEffect((function(){w.getInitialCards(fe).then((function(e){Q(e.data)})).catch((function(e){console.log(e)}))}),[fe]),Object(m.jsx)(h.Provider,{value:H,children:Object(m.jsxs)("div",{className:"root",children:[Object(m.jsxs)(l.d,{children:[Object(m.jsxs)(T,{path:"/main",loggedIn:ne,children:[Object(m.jsx)(j,{link:"/signin",linkText:"Log out",email:he,loggedIn:ne,onLogOut:xe}),Object(m.jsx)(p,{onLogOut:xe,component:p,onEditAvatarClick:function(){c(!0)},onEditProfileClick:function(){b(!0)},onAddPlaceClick:function(){S(!0)},onCardLike:function(e){e.likes.some((function(e){return e._id===H._id}))?w.removeLike(e._id,fe).then((function(t){Q((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch((function(e){console.log(e)})):w.addLike(e._id,fe).then((function(t){Q((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch((function(e){console.log(e)}))},onCardDelete:function(e){U(!0),$(e)},onCardClick:function(e){J(e)},cards:K,email:he,onClose:ve}),Object(m.jsx)(_,{}),Object(m.jsx)(v,{isOpen:d,onClose:ve,onUpdateUser:function(e){w.editProfile(e,fe).then((function(e){Y(e),ve()})).catch((function(e){console.log(e)}))}}),Object(m.jsx)(g,{isOpen:a,onClose:ve,onUpdateAvatar:function(e){w.editAvatar(e,fe).then((function(e){Y(e),ve()})).catch((function(e){console.log(e)}))}}),Object(m.jsx)(O,{isOpen:y,onClose:ve,onAddPlace:function(e){var t=e.name,n=e.link;w.addCard({name:t,link:n},fe).then((function(e){Q([e.data].concat(Object(s.a)(K))),ve()})).catch((function(e){console.log(e)}))}}),Object(m.jsx)(x,{cardToDelete:Z,isOpen:E,onClose:ve,onSubmit:function(e){w.deleteCard(e._id,fe).then((function(){Q((function(t){return t.filter((function(t){return t._id!==e._id}))})),ve()})).catch((function(e){console.log(e)}))}}),Object(m.jsx)(k,{card:z,onClose:ve})]}),Object(m.jsx)(l.b,{path:"/signin",children:Object(m.jsx)(C,{handleLogin:function(t,n){t&&n&&function(e,t){return fetch("".concat(D,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return R(e)})).then((function(e){return e.token?(localStorage.setItem("token",e.token),e):void 0})).catch((function(e){return console.log(e)}))}(t,n).then((function(n){n.token&&(localStorage.setItem("token",n.token),Oe(n.token),ae(!0),be(t),e.push("/main"))})).catch((function(e){console.log(e)}))}})}),Object(m.jsx)(l.b,{path:"/signup",children:Object(m.jsx)(I,{handleRegister:function(t,n){t&&n&&function(e,t){return fetch("".concat(D,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return R(e)})).then((function(e){return e})).catch((function(e){return console.log(e)}))}(t,n).then((function(t){t?(se(!0),ge(),e.push("/signin")):(se(!1),ge())})).then(ge).catch((function(e){se(!1),ge(),console.log(e)}))}})}),Object(m.jsx)(l.b,{exact:!0,path:"/",children:ne?Object(m.jsx)(l.a,{to:"/main"}):Object(m.jsx)(l.a,{to:"/signin"})})]}),Object(m.jsx)(P,{isRegistered:ie,isOpen:ue,onClose:ve})]})})},q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,39)).then((function(t){var n=t.getCLS,a=t.getFID,o=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),o(e),c(e),i(e)}))};i.a.render(Object(m.jsx)(o.a.StrictMode,{children:Object(m.jsx)(d.a,{children:Object(m.jsx)(B,{})})}),document.getElementById("root")),q()}},[[38,1,2]]]);
//# sourceMappingURL=main.6eaa18f0.chunk.js.map